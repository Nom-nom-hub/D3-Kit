---
description: Create a new feature specification from a user description
scripts:
  sh: scripts/bash/d3-intend.sh "{ARGS}"
  ps: scripts/powershell/d3-intend.ps1 "{ARGS}"
---

# /d3.intend - Create Feature Specification

## CRITICAL: Execute Script First

**DO NOT manually fill out the template below.** Instead, you MUST execute the script to create the spec file.

### Step 1: Execute the Script

Run the script with the user's description:

**On Linux/Mac (bash):**
```bash
bash scripts/bash/d3-intend.sh "$ARGUMENTS"
```

**On Windows (PowerShell):**
```powershell
. scripts/powershell/d3-intend.ps1 "$ARGUMENTS"
```

### Step 2: Parse the JSON Output

The script will return JSON like:
```json
{
  "status": "success",
  "message": "Feature specification created successfully",
  "data": {
    "branch_name": "001-feature-name",
    "feature_number": 1,
    "feature_name": "feature-name",
    "feature_dir": "/path/to/d3-features/001-feature-name",
    "spec_file": "/path/to/d3-features/001-feature-name/spec.md"
  }
}
```

### Step 3: MANDATORY IMMEDIATE ACTION - Open and Edit the spec.md File NOW

**⚠️ STOP. DO NOT REPORT SUCCESS YET.**

**The script ONLY created an empty template with brackets. You MUST continue immediately with file editing before confirming to user.**

The file path from JSON above: `data.spec_file` - **Open this file RIGHT NOW.**

**Perform these edits immediately:**

#### 3a. Developer Intent & User Scenarios
Replace:
```
- **Developer Intent**: [What are you trying to achieve technically with {FEATURE_NAME}?]
```
With specific answer. For calculator example:
```
- **Developer Intent**: Create an offline-capable calculator application with an innovative, visually distinct interface that works entirely in the browser without network connectivity.
```

Replace all placeholder lines with actual content for:
- Primary User Scenario (how users will actually use this)
- Secondary User Scenarios (other use cases)
- Target Audience (who will use this)

#### 3b. Functional Requirements
Replace the `[ ] Requirement X:` checklist items with actual requirements extracted from user description. Example:
```
- [x] Offline Functionality: Calculator must work without internet connection
- [x] Unique Interface: UI must be visually distinctive from standard calculators  
- [x] HTML-Based: Built with HTML/CSS/JavaScript (no frameworks required)
- [x] Basic Operations: Support +, -, *, / calculations
```

#### 3c. Edge Cases & Clarifications
List specific edge cases and open questions:
```
- [ ] What math operations are required? (basic 4, or scientific functions?)
- [ ] Precision: How many decimal places?
- [ ] History: Should calculation history be saved?
- [ ] Mobile: Must work on mobile devices?
- [ ] Browsers: Which browsers must be supported?
```

#### 3d. Key Entities
Define what data objects this feature works with:
```
- Calculator State: Current input, previous result, operation pending
- Calculation History: List of calculations performed
- User Interaction: Buttons pressed, number inputs
```

#### 3e. Success Criteria  
Define measurable success:
```
- [ ] All basic math operations (+, -, *, /) work correctly offline
- [ ] UI is visually unique and pleasant to use
- [ ] Works without network connectivity
- [ ] Loads in under 2 seconds
```

### Step 4: Confirm to User with DETAILS

Do NOT just say "created spec.md". Report what you filled in:

```
✓ Created spec.md for feature: 1-a-calculator-in-html
  Location: d3-features/1-a-calculator-in-html/spec.md
  
✓ FILLED IN:
  • Developer Intent: Offline calculator with unique interface
  • Functional Requirements: 5 requirements defined
  • Edge Cases: 5 clarifications documented
  • Key Entities: Calculator State, History, User Interaction
  • Success Criteria: 4 measurable success metrics

⚠ CLARIFICATIONS NEEDED FROM USER:
  • Which math operations? (Basic 4 vs. scientific)
  • Mobile device support required?
  • Browser compatibility requirements?
```

**Example response:**
```
✓ Created spec.md for feature: 001-offline-calculator
  Location: d3-features/001-offline-calculator/spec.md
  Branch: 001-offline-calculator
  
✓ Filled in:
  - Developer Intent & User Scenarios
  - Functional Requirements (basic)
  - Edge Cases identified
  
⚠ Clarifications needed:
  - Target user devices/browsers
  - Data persistence requirements
```

---

## What the Script Does

The d3-intend script:
1. Generates a feature name from the description (2-4 word kebab-case)
2. Finds the next available feature number
3. Creates `d3-features/NNN-feature-name/` directory
4. Loads the spec template
5. Fills in feature information (name, date, description)
6. Creates `spec.md` file
7. Optionally creates a git branch
8. Returns JSON with file paths

## User Input

The feature description provided by the user is: `$ARGUMENTS`

---

## If Script Execution Fails

If the script returns an error:
1. Check that `.d3/scripts/` directory exists
2. Verify `d3-features/` directory is writable
3. Check that templates exist in `D3-templates/`
4. Show the user the error message from the script

## Reference: What Gets Created

The script creates spec.md with these sections:
- Feature Information (branch, date, status) - **Auto-filled by script**
- Developer Intent & User Scenarios - **Agent fills in from user description**
- Edge Cases & Clarifications - **Agent identifies from user description**
- Functional Requirements - **Agent extracts from user description**
- Key Entities - **Agent identifies entities mentioned**
- Success Criteria - **Agent defines based on feature description**
- Intent Alignment Check - **User reviews**
- Out of Scope - **Agent identifies limitations**
- Questions & Clarifications - **Agent lists open questions**

## Important: Agent Workflow

This command is not complete until:
1. ✓ Script runs successfully and creates files
2. ✓ Agent opens the generated spec.md
3. ✓ Agent fills in all relevant sections from user's description
4. ✓ Agent asks clarifying questions if needed
5. ✓ User has a complete feature specification ready for d3.plan
